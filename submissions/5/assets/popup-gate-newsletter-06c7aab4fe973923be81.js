(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["popup-gate-newsletter"],{"./src/ts/components/popup-gate-newsletter/popup-gate-newsletter.ts":(e,t,s)=>{"use strict";s.r(t),s.d(t,{getSignedUp:()=>l,show:()=>u,hide:()=>m,subscribeToCRM:()=>w,subscriptionSuccess:()=>b,subscribe:()=>g,popupGateNewsletterComponent:()=>h,init:()=>y});var n=s("../react-components/dist/components/global/newsletter/popup-newsletter/popup-newsletter.css.json"),r=s("../shared-types/frontend/components/newsletter/subscription-status.ts"),o=s("../shared-types/frontend/core/store.ts"),p=s("../../node_modules/js-cookie/src/js.cookie.js"),i=s.n(p),c=s("./src/ts/utils/crm.ts"),a=s("./src/ts/utils/inview.ts");const l=()=>!!i().get(r.y.SignedUp),d=(e,t)=>{e.setAttribute("hidden","false"),t.dispatch({type:o.U.TrackEvent,payload:{pev2:"newsletter popup gate displayed",events:["event113"]}})},u=(e,t)=>()=>{const s=document.querySelector("#inline-placement")||document.querySelector(".anyclip-placement");(null==s?void 0:s.childNodes.length)?(0,a.oO)({element:s,isNotInViewportCallback:()=>{d(e,t)}}):d(e,t)},m=(e,t)=>()=>{e.setAttribute("hidden","true"),t.dispatch({type:o.U.TrackEvent,payload:{pev2:"newsletter popup gate dismissed",events:["event207"]}})},w=({popupGateElement:e,store:t})=>{const s=t.subscribe(()=>{const r=t.getState();if(r.crm.receive)s(),b({popupGateElement:e,type:r.crm.receive.type});else if(r.crm.error){e.querySelector("."+n.N3).innerHTML=r.crm.error.message,e.classList.add(n.yt)}})},b=({popupGateElement:e,type:t})=>{if(e.classList.add(n.UJ),"popup-gate"===t){(0,c.W)(t);const s=e.dataset.popupGateNewsletterRedirectUrl;window.location.href=s}},g=(e,t)=>s=>{s.preventDefault();const r=e.querySelector(`.${n.Y2}.${n.Do}`);(0,c.C)(t,{copyVersion:"0001",element:"newsletter-popup-gate",email:r.value,referrer:window.location.href})},h=(e,t)=>{const s={submitListener:g(e,t),hideListener:m(e,t),init:()=>{if(l()||!window.digitalMagazinePage)return e.remove(),{};return e.querySelector("."+n.Ah).addEventListener("click",s.hideListener),e.querySelector("."+n.cZ).addEventListener("click",s.hideListener),e.querySelector("."+n.cr).addEventListener("submit",s.submitListener),w({popupGateElement:e,store:t}),{hide:s.hideListener,submit:s.submitListener}}};return s},y=(e,t)=>{const s=Math.floor(1e4*Math.random());return{listeners:h(e,t).init(),componentId:"popup-gate-newsletter-component-"+s}}}}]);