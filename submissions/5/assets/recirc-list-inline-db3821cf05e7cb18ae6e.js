(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["recirc-list-inline"],{"../../node_modules/ramda/es/internal/_curry1.js":(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n("../../node_modules/ramda/es/internal/_isPlaceholder.js");function s(e){return function t(n){return 0===arguments.length||(0,r.Z)(n)?t:e.apply(this,arguments)}}},"../../node_modules/ramda/es/internal/_curry2.js":(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n("../../node_modules/ramda/es/internal/_curry1.js"),s=n("../../node_modules/ramda/es/internal/_isPlaceholder.js");function i(e){return function t(n,i){switch(arguments.length){case 0:return t;case 1:return(0,s.Z)(n)?t:(0,r.Z)((function(t){return e(n,t)}));default:return(0,s.Z)(n)&&(0,s.Z)(i)?t:(0,s.Z)(n)?(0,r.Z)((function(t){return e(t,i)})):(0,s.Z)(i)?(0,r.Z)((function(t){return e(n,t)})):e(n,i)}}}},"../../node_modules/ramda/es/internal/_curry3.js":(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n("../../node_modules/ramda/es/internal/_curry1.js"),s=n("../../node_modules/ramda/es/internal/_curry2.js"),i=n("../../node_modules/ramda/es/internal/_isPlaceholder.js");function c(e){return function t(n,c,o){switch(arguments.length){case 0:return t;case 1:return(0,i.Z)(n)?t:(0,s.Z)((function(t,r){return e(n,t,r)}));case 2:return(0,i.Z)(n)&&(0,i.Z)(c)?t:(0,i.Z)(n)?(0,s.Z)((function(t,n){return e(t,c,n)})):(0,i.Z)(c)?(0,s.Z)((function(t,r){return e(n,t,r)})):(0,r.Z)((function(t){return e(n,c,t)}));default:return(0,i.Z)(n)&&(0,i.Z)(c)&&(0,i.Z)(o)?t:(0,i.Z)(n)&&(0,i.Z)(c)?(0,s.Z)((function(t,n){return e(t,n,o)})):(0,i.Z)(n)&&(0,i.Z)(o)?(0,s.Z)((function(t,n){return e(t,c,n)})):(0,i.Z)(c)&&(0,i.Z)(o)?(0,s.Z)((function(t,r){return e(n,t,r)})):(0,i.Z)(n)?(0,r.Z)((function(t){return e(t,c,o)})):(0,i.Z)(c)?(0,r.Z)((function(t){return e(n,t,o)})):(0,i.Z)(o)?(0,r.Z)((function(t){return e(n,c,t)})):e(n,c,o)}}}},"../../node_modules/ramda/es/internal/_isPlaceholder.js":(e,t,n)=>{"use strict";function r(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}n.d(t,{Z:()=>r})},"../../node_modules/ramda/es/nth.js":(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=(0,n("../../node_modules/ramda/es/internal/_curry2.js").Z)((function(e,t){var n,r=e<0?t.length+e:e;return n=t,"[object String]"===Object.prototype.toString.call(n)?t.charAt(r):t[r]}))},"./src/ts/components/recirc/recirc-list-inline.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{RecircListInline:()=>P,init:()=>j});var r=n("../shared-types/frontend/core/store.ts"),s=n("../shared-types/frontend/utils/discover.ts"),i=n("../../node_modules/ramda/src/pathOr.js"),c=n.n(i),o=n("./src/ts/utils/discover.ts"),a=n("../../node_modules/ramda/es/internal/_curry3.js"),l=n("../../node_modules/ramda/es/internal/_curry2.js");const u=(0,l.Z)((function(e,t){return null==t||t!=t?e:t})),d=Number.isInteger||function(e){return e<<0===e};var m=n("../../node_modules/ramda/es/nth.js");const g=(0,l.Z)((function(e,t){return e.map((function(e){for(var n,r=t,s=0;s<e.length;){if(null==r)return;n=e[s],r=d(n)?(0,m.Z)(n,r):r[n],s+=1}return r}))}));const p=(0,l.Z)((function(e,t){return g([e],t)[0]}));const f=(0,a.Z)((function(e,t,n){return u(e,p(t,n))}));const h=(0,a.Z)((function(e,t,n){return f(e,[t],n)}));var _=n("./src/ts/utils/recirc.ts"),y=n("./src/ts/utils/request.ts");const v={},w=({data:e,size:t,storageName:n,resolve:r})=>{const s=(0,_.G4)(n),i=e.splice(0,t+s.length);r(function(e){const t=[...e];for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}((0,_.mO)(t,(0,_.G4)(n),i)))},Z=e=>{e.listeners.forEach(t=>t(e.data)),e.listeners=[]},D=({size:e=4,storageName:t="",uid:n="",request:r={url:"",headers:{}}})=>{const s={...r},i=s.url.replace(/(size=)\d+/,"size=20");return s.url=i,(0,_.TG)(t,n),new Promise((n,r)=>{const c=h(!1,i,v);c||(v[i]={isReady:!1,data:[],listeners:[r=>w({data:r,size:e,storageName:t,resolve:n})]},(0,y.A_)(s).then(({body:e})=>{v[i].isReady=!0,v[i].data=e,Z(v[i])}).catch(r));const o=f(!1,[i,"isReady"],v);c&&!o&&v[i].listeners.push(r=>w({data:r,size:e,storageName:t,resolve:n})),o&&(v[i].listeners.push(r=>w({data:r,size:e,storageName:t,resolve:n})),Z(v[i]))})};var A=n("./src/ts/utils/inview.ts");const P=()=>{const e={isTrackingLoaded:!1,buildTemplate:(e,t,n)=>{const r=e.querySelector("template"),s=e.querySelector(".js_recirc_list_items");r&&s&&s.insertAdjacentHTML("beforeend",(0,o.Ec)({data:t,template:r.content,trackingUID:`recirc_inline_recommended_4::${n+1}::`,aspectRatio:"16-9"}))},generateTemplate:(t,n)=>{if(!n.length)return;const s=document.querySelectorAll(".inline-clone[data-component=recirc-list-inline]");if(!s.length)return;let i=0;s.forEach((s,c)=>{if(!s.classList.contains("recirc-ready")){const o=4*i,a=4*(i+1),l=n.slice(o,a);l.length&&4==l.length&&(e.buildTemplate(s,l,c),s.querySelector(".js_recirc_content").classList.remove("hide"),(0,A.W0)(s).then(()=>{t.dispatch({type:r.U.RecircListInlineInview,payload:{events:["event229"],pev2:"recircinview_inline_recommended_4::"+(c+1),timestamp:Date.now()}})}).catch(e=>{console.error(e)}),i++)}})},getPositionCards:()=>{const e=[...document.querySelectorAll(".zoneItems >.tile")].filter(e=>null===e.querySelector(".js-ecom_widget")),t=e.length-5;let n=0;return e.reduce((e,r,s)=>(s>=9&&s<=t&&(9===s||29===n?(e.push(r),n=0):n++),e),[])},positionElements:t=>{const{rootElement:n}=t;n&&e.getPositionCards().forEach((e,t)=>{const r=e.nextElementSibling;if(!r||r&&!r.classList.contains("inline-clone")){const r=n.cloneNode(!0);r.classList.add("inline-clone","inline-clone-"+(t+1)),e.insertAdjacentElement("afterend",r),e.classList.add("list-card-recirc-inline")}})},render:(t,n,s)=>{if(s.length&&!(s.length<2))return e.positionElements(t),e.generateTemplate(n,s),document.querySelectorAll(".inline-clone[data-module=recirc_list_2]").forEach(e=>{e.classList.add("recirc-ready")}),e.isTrackingLoaded||(n.dispatch({type:r.U.RecircListInlineLoaded,payload:{events:["event229"],pev2:"recircloaded_inline_recommended_4"}}),e.isTrackingLoaded=!0),{}},getData:async(t,n)=>{try{const r="Content-Page-"+c()("",["hostUid"],t.rootElement.dataset),i=e.getPositionCards().filter(e=>!e.classList.contains("list-card-recirc-inline")).length;if(0===i)return Promise.reject("Recirc inline: list cards not matching requirements");const a=4*i,l=await D({size:a,storageName:"to_recirc_visited_history",uid:r,request:(0,o.fg)({uid:r,size:a,filters:[s.v.ORContentTypePage,s.v.ANDCommercialFalse],sorters:[s.R.PublishedAtDesc]})});return e.render(t,n,l),l}catch(e){console.error(e)}},bindEvents:(t,n)=>{const r=(e=>({rootElement:e,template:e.querySelector("template"),content:e.querySelector(".js_recirc_content"),wrap:e.querySelector(".js_recirc_list_items")}))(t);return e.getData(r,n),{}}};return e},j=(e,t)=>{const n=Math.floor(1e4*Math.random());return{listeners:P().bindEvents(e,t),componentId:"recirc-list-inline-"+n}}},"./src/ts/utils/discover.ts":(e,t,n)=>{"use strict";n.d(t,{fg:()=>o,Ec:()=>l});var r=n("./src/ts/config/config.ts"),s=n("./src/ts/utils/parsely.ts"),i=n("./src/ts/utils/request.ts"),c=n("./src/ts/utils/responsive-image.ts");const o=({uid:e="",size:t=6,from:n,filters:s,sorters:c}={})=>{const o=(0,r.u)("site"),a=(0,r.u)("locale"),l=(0,r.u)("discover"),u={size:t};return s&&(u.filters=s.join(",")),c&&(u.sorters=c.join(",")),n&&(u.from=n),{url:(0,i.am)({urlPrefix:`${l}/recirc/${o}/${a}/${e}`,params:u})}},a=({index:e,item:t,trackingUID:n,type:r})=>({prop45:`${n}::${e+1}::${t.uid}`,prop60:t.name,pev2:"list "+r,events:["event232"]}),l=({data:e,template:t,trackingUID:n,aspectRatio:r})=>{const i=document.createElement("div");i.appendChild(t.cloneNode(!0));const o=i.innerHTML;return e.reduce((e,t,i)=>{const l=(0,s.QI)(t.web_url),u=t.image_url?t.image_url.replace("/image.jpg","/{width}/{height}/image.jpg"):"https://media.timeout.com/images/105716137/{width}/{height}/image.jpg",d=(0,c.J)({pattern:u,aspectRatioKey:r,title:t.name,alt:t.name});return e+o.replace(/\[cta_link\]/g,l).replace(/\[title\]/g,t.name).replace(/\[image\]/g,d).replace(/\[tracking_tile\]/g,JSON.stringify(a({trackingUID:n,type:"tile",index:i,item:t})).replace(/"/g,"&quot;")).replace(/\[tracking_image\]/g,JSON.stringify(a({trackingUID:n,type:"image",index:i,item:t})).replace(/"/g,"&quot;")).replace(/\[host_uid\]/g,t.uid)},"")}},"./src/ts/utils/inview.ts":(e,t,n)=>{"use strict";n.d(t,{oe:()=>r,oO:()=>s,W0:()=>i});const r=e=>{if(!e)return!1;const t=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,r=window.innerWidth||document.documentElement.clientWidth,s=t.top<=n&&t.top+t.height>=0,i=t.left<=r&&t.left+t.width>=0;return s&&i};function s({element:e,observerOptions:t={},isInViewportCallback:n,isNotInViewportCallback:r}){new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&n&&(r||t.unobserve(e.target),n(e)),!e.isIntersecting&&r&&(n||t.unobserve(e.target),r(e))})},t).observe(e)}function i(e,t){return e?new Promise(n=>{s({element:e,observerOptions:t,isInViewportCallback:n})}):Promise.reject()}},"./src/ts/utils/recirc.ts":(e,t,n)=>{"use strict";n.d(t,{G4:()=>r,TG:()=>s,mO:()=>i});const r=(e="")=>window.sessionStorage&&window.sessionStorage.getItem(e)&&JSON.parse(window.sessionStorage.getItem(e))||[],s=(e="",t="")=>{if(!window.sessionStorage)return;const n=r(e);return n.includes(t)||(n.push(t),sessionStorage.setItem(e,JSON.stringify(n))),t},i=(e=0,t=[],n=[])=>{const r=n.filter(e=>!t.includes(e.uid));return r.length>e?r.slice(0,e):r}},"../shared-types/frontend/utils/discover.ts":(e,t,n)=>{"use strict";var r,s;n.d(t,{v:()=>r,R:()=>s}),function(e){e[e.ORContentTypePost=100]="ORContentTypePost",e[e.ORContentTypePage=101]="ORContentTypePage",e[e.ORContentTypeVenue=102]="ORContentTypeVenue",e[e.ORContentTypeEvent=103]="ORContentTypeEvent",e[e.ANDCommercialFalse=104]="ANDCommercialFalse",e[e.ANDCommercialTrue=105]="ANDCommercialTrue",e[e.ANDUpdatedAtGte2MAgo=107]="ANDUpdatedAtGte2MAgo"}(r||(r={})),function(e){e[e.PublishedAtDesc=200]="PublishedAtDesc",e[e.PublishedAtAsc=201]="PublishedAtAsc",e[e.EndDateDesc=202]="EndDateDesc",e[e.EndDateAsc=203]="EndDateAsc",e[e.UpdatedAtDesc=204]="UpdatedAtDesc",e[e.UpdatedAtAsc=205]="UpdatedAtAsc",e[e.GeoDistanceAsc=206]="GeoDistanceAsc",e[e.PopularityDesc=207]="PopularityDesc",e[e.PopularityAsc=208]="PopularityAsc",e[e.PageViews6HDesc=209]="PageViews6HDesc",e[e.PageViews12HDesc=210]="PageViews12HDesc",e[e.PageViews24HDesc=211]="PageViews24HDesc",e[e.PageViews7DDesc=212]="PageViews7DDesc"}(s||(s={}))}}]);