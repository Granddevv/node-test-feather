(window.webpackJsonp_gp_web_frontend=window.webpackJsonp_gp_web_frontend||[]).push([["sidebar-recirc"],{"./src/ts/components/recirc/sidebar-recirc.ts":(e,t,s)=>{"use strict";s.r(t),s.d(t,{SidebarRecirc:()=>u,init:()=>g});var r=s("../shared-types/frontend/core/store.ts"),i=s("../shared-types/frontend/utils/discover.ts"),n=s("../../node_modules/ramda/src/pathOr.js"),a=s.n(n),c=s("./src/ts/core/client.ts"),o=s("./src/ts/utils/discover.ts"),p=s("./src/ts/utils/recirc.ts"),d=s("./src/ts/utils/request.ts");const l="to_recirc_visited_history",u=()=>{const e={buildTemplate:(e,t)=>{const{wrap:s,template:r}=e;r&&s&&s.insertAdjacentHTML("beforeend",(0,o.Ec)({data:t,template:r.content,trackingUID:"recirc_rightrail_popular_5::",aspectRatio:"16-9"}))},render:(t,s,i,n)=>{if(!a()(!1,["meta"],n)||!a()(!1,["body"],n))return;const{body:c}=n;if(!c.length||c.length<2)return;const{hostUid:o,pageType:d}=s;(0,p.TG)(l,`Content-${d}-${o}`);const u=(0,p.mO)(5,(0,p.G4)(l),c);return e.buildTemplate(t,u),t.content.classList.remove("hide"),i.dispatch({type:r.U.RecircSidebarLoaded,payload:{events:["event229"],pev2:"recircloaded_rightrail_popular_5"}}),{}},getData:async(t,s,r)=>{try{const{hostUid:n,pageType:a}=s,c=`Content-${a}-${n}`,u=5+(0,p.G4)(l).length,g=[i.R.PageViews24HDesc],m=await(0,d.A_)((0,o.fg)({uid:c,size:u,filters:[i.v.ORContentTypePost,i.v.ORContentTypePage,i.v.ORContentTypeVenue,i.v.ORContentTypeEvent,i.v.ANDCommercialFalse,i.v.ANDUpdatedAtGte2MAgo],sorters:g}));return e.render(t,s,r,m),m}catch(e){console.error(e)}},bindEvents:(t,s)=>{const i=(e=>({type:a()("",["pageType"],e.dataset),pageType:a()("",["pageType"],e.dataset).replace("listfeature","page").replace(/^\w/,e=>e.toUpperCase()),hostUid:a()("",["hostUid"],e.dataset)}))(t);if("post"===i.type&&"xs"===(0,c.iu)())return{};s.dispatch({type:r.U.RecircSidebarInview,payload:{events:["event229"],pev2:"recircinview_rightrail_popular_5"}});const n=(e=>({rootElement:e,template:e.querySelector("template"),content:e.querySelector(".js_recirc_content"),wrap:e.querySelector(".js_recirc_list_items")}))(t);return e.getData(n,i,s),{}}};return e},g=(e,t)=>{const s=Math.floor(1e4*Math.random());return{listeners:u().bindEvents(e,t),componentId:"sidebar-recirc-"+s}}},"./src/ts/utils/discover.ts":(e,t,s)=>{"use strict";s.d(t,{fg:()=>c,Ec:()=>p});var r=s("./src/ts/config/config.ts"),i=s("./src/ts/utils/parsely.ts"),n=s("./src/ts/utils/request.ts"),a=s("./src/ts/utils/responsive-image.ts");const c=({uid:e="",size:t=6,from:s,filters:i,sorters:a}={})=>{const c=(0,r.u)("site"),o=(0,r.u)("locale"),p=(0,r.u)("discover"),d={size:t};return i&&(d.filters=i.join(",")),a&&(d.sorters=a.join(",")),s&&(d.from=s),{url:(0,n.am)({urlPrefix:`${p}/recirc/${c}/${o}/${e}`,params:d})}},o=({index:e,item:t,trackingUID:s,type:r})=>({prop45:`${s}::${e+1}::${t.uid}`,prop60:t.name,pev2:"list "+r,events:["event232"]}),p=({data:e,template:t,trackingUID:s,aspectRatio:r})=>{const n=document.createElement("div");n.appendChild(t.cloneNode(!0));const c=n.innerHTML;return e.reduce((e,t,n)=>{const p=(0,i.QI)(t.web_url),d=t.image_url?t.image_url.replace("/image.jpg","/{width}/{height}/image.jpg"):"https://media.timeout.com/images/105716137/{width}/{height}/image.jpg",l=(0,a.J)({pattern:d,aspectRatioKey:r,title:t.name,alt:t.name});return e+c.replace(/\[cta_link\]/g,p).replace(/\[title\]/g,t.name).replace(/\[image\]/g,l).replace(/\[tracking_tile\]/g,JSON.stringify(o({trackingUID:s,type:"tile",index:n,item:t})).replace(/"/g,"&quot;")).replace(/\[tracking_image\]/g,JSON.stringify(o({trackingUID:s,type:"image",index:n,item:t})).replace(/"/g,"&quot;")).replace(/\[host_uid\]/g,t.uid)},"")}},"./src/ts/utils/recirc.ts":(e,t,s)=>{"use strict";s.d(t,{G4:()=>r,TG:()=>i,mO:()=>n});const r=(e="")=>window.sessionStorage&&window.sessionStorage.getItem(e)&&JSON.parse(window.sessionStorage.getItem(e))||[],i=(e="",t="")=>{if(!window.sessionStorage)return;const s=r(e);return s.includes(t)||(s.push(t),sessionStorage.setItem(e,JSON.stringify(s))),t},n=(e=0,t=[],s=[])=>{const r=s.filter(e=>!t.includes(e.uid));return r.length>e?r.slice(0,e):r}},"../shared-types/frontend/utils/discover.ts":(e,t,s)=>{"use strict";var r,i;s.d(t,{v:()=>r,R:()=>i}),function(e){e[e.ORContentTypePost=100]="ORContentTypePost",e[e.ORContentTypePage=101]="ORContentTypePage",e[e.ORContentTypeVenue=102]="ORContentTypeVenue",e[e.ORContentTypeEvent=103]="ORContentTypeEvent",e[e.ANDCommercialFalse=104]="ANDCommercialFalse",e[e.ANDCommercialTrue=105]="ANDCommercialTrue",e[e.ANDUpdatedAtGte2MAgo=107]="ANDUpdatedAtGte2MAgo"}(r||(r={})),function(e){e[e.PublishedAtDesc=200]="PublishedAtDesc",e[e.PublishedAtAsc=201]="PublishedAtAsc",e[e.EndDateDesc=202]="EndDateDesc",e[e.EndDateAsc=203]="EndDateAsc",e[e.UpdatedAtDesc=204]="UpdatedAtDesc",e[e.UpdatedAtAsc=205]="UpdatedAtAsc",e[e.GeoDistanceAsc=206]="GeoDistanceAsc",e[e.PopularityDesc=207]="PopularityDesc",e[e.PopularityAsc=208]="PopularityAsc",e[e.PageViews6HDesc=209]="PageViews6HDesc",e[e.PageViews12HDesc=210]="PageViews12HDesc",e[e.PageViews24HDesc=211]="PageViews24HDesc",e[e.PageViews7DDesc=212]="PageViews7DDesc"}(i||(i={}))}}]);